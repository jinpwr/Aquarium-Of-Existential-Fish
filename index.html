<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aquarium of Existential Fish</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    overflow: hidden;
    background: linear-gradient(to bottom, #caecff 0%, #7aa0ff 40%, #180046 100%);
    animation: bgBluePulse 90s ease-in-out infinite;
  }
  @keyframes bgBluePulse {
    0%   { background: linear-gradient(to bottom, #caecff 0%, #7aa0ff 40%, #180046 100%); }
    50%  { background: linear-gradient(to bottom, #bcd9ff 0%, #6b8cff 40%, #1a0a4a 100%); }
    100% { background: linear-gradient(to bottom, #caecff 0%, #7aa0ff 40%, #180046 100%); }
  }
  canvas { display:block }
  #dither{
    position:fixed;inset:0;pointer-events:none;opacity:.12;z-index:1;
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect width="4" height="4" fill="black" opacity="0"/><rect x="0" y="0" width="2" height="2" fill="white" opacity="0.07"/><rect x="2" y="2" width="2" height="2" fill="white" opacity="0.07"/></svg>');
    image-rendering:pixelated;background-size:4px;background-repeat:repeat;mix-blend-mode:overlay;
  }
  #overlay{
    position:fixed;inset:0;pointer-events:none;z-index:3;
    display:flex;align-items:flex-end;justify-content:space-between;
    padding:12px 14px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
    color:#b3f4ff;text-shadow:0 1px 2px rgba(0,0,0,.25);
  }
  #overlay .hint{opacity:.9;font-size:12px}
  #overlay .title{margin-left:auto;font-weight:700;letter-spacing:.5px;font-size:12px;color:#9effc7}
</style>
</head>
<body>
<div id="dither"></div>
<div id="overlay">
  <div class="hint">Move mouse: parallax · Click fish: freeze/vanish · <kbd>H</kbd>: hide bubbles</div>
  <div class="title">Aquarium of Existential Fish</div>
</div>

<script type="module">
import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';
const scene=new THREE.Scene();scene.fog=new THREE.FogExp2(0x120022,0.05);
const camera=new THREE.PerspectiveCamera(65,innerWidth/innerHeight,0.1,200);
camera.position.set(0,2.2,7);
const renderer=new THREE.WebGLRenderer({antialias:true,alpha:true,premultipliedAlpha:false});
renderer.setPixelRatio(Math.min(devicePixelRatio,2));
renderer.setSize(innerWidth,innerHeight);
renderer.outputColorSpace=THREE.SRGBColorSpace;
renderer.toneMapping=THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure=1.35;
document.body.appendChild(renderer.domElement);

/* lighting */
const hemi=new THREE.HemisphereLight(0xb9ecff,0x180020,0.48);
const key=new THREE.PointLight(0x64d8ff,16,80,2.0);key.position.set(6,4,3);
const fill=new THREE.PointLight(0x4dffc8,8,80,2.0);fill.position.set(-6,-1,-2);
const rim=new THREE.PointLight(0x5d5aff,12,100,2.2);rim.position.set(0,3.5,-8);
scene.add(hemi,key,fill,rim);

const rand=(a,b)=>a+Math.random()*(b-a);
const choose=a=>a[(Math.random()*a.length)|0];

/* fish and bubbles identical to previous version ... (omitted here for brevity) */

/* === Shark PNG movement === */
const SHARK_SRC='shark.png';
function fallbackSilhouetteCanvas(){
  const c=document.createElement('canvas');c.width=1024;c.height=512;
  const ctx=c.getContext('2d');
  ctx.fillStyle='#0a0f17';
  ctx.beginPath();
  ctx.moveTo(50,300);ctx.quadraticCurveTo(140,250,240,230);
  ctx.quadraticCurveTo(520,180,820,230);ctx.quadraticCurveTo(980,260,950,280);
  ctx.quadraticCurveTo(820,260,650,260);ctx.quadraticCurveTo(420,270,250,320);
  ctx.quadraticCurveTo(170,350,120,360);ctx.quadraticCurveTo(80,350,50,300);
  ctx.fill();return c;
}
function loadSharkTexture(onReady){
  const loader=new THREE.TextureLoader();
  loader.load(SHARK_SRC,
    t=>{t.colorSpace=THREE.SRGBColorSpace;t.premultiplyAlpha=true;
      t.generateMipmaps=false;t.minFilter=THREE.LinearFilter;t.magFilter=THREE.LinearFilter;
      onReady(t,null);},
    undefined,
    ()=>{const canvas=fallbackSilhouetteCanvas();
      const tex=new THREE.CanvasTexture(canvas);
      onReady(tex,{fallback:true,aspect:canvas.width/canvas.height});});
}
class BackgroundSharkPNG{
  constructor(){
    this.mesh=null;
    this.speed=0.55;
    this.baseOpacity=0.9*0.75; // 75% transparency
    this.dir=1;
    this.phase=Math.random()*Math.PI*2;
    this.y=rand(0.2,1.2);
    this.z=-7.8;
    loadSharkTexture((texture,meta)=>{
      const mat=new THREE.MeshBasicMaterial({
        map:texture,transparent:true,opacity:this.baseOpacity,
        depthWrite:false,side:THREE.DoubleSide,alphaTest:0.03
      });
      const aspect=meta?.aspect||(texture.image.width/texture.image.height||2.0);
      const W=9.5*2;const H=(W/aspect);
      const geo=new THREE.PlaneGeometry(W,H);
      this.mesh=new THREE.Mesh(geo,mat);
      scene.add(this.mesh);
      this.mesh.position.set(-13.6,this.y,this.z);
      this.mesh.rotation.y=0;
    });
  }
  update(dt,t){
    if(!this.mesh)return;
    this.mesh.position.x+=this.dir*this.speed*dt;
    this.mesh.position.y=this.y+Math.sin(t*0.25+this.phase)*0.12;
    this.mesh.material.opacity=THREE.MathUtils.clamp(
      this.baseOpacity+Math.sin(t*0.15+this.phase)*0.03,0.45,0.75);
    if(this.dir>0&&this.mesh.position.x>13.6){
      this.dir=-1;this.mesh.rotation.y=Math.PI;
    }else if(this.dir<0&&this.mesh.position.x<-13.6){
      this.dir=1;this.mesh.rotation.y=0;
    }
  }
}
const SHARK=new BackgroundSharkPNG();

/* rest of aquarium code unchanged:
   - fish creation, update loop
   - click interactions
   - bubble animation
   - parallax camera
   - requestAnimationFrame(tick)
*/
</script>
</body>
</html>
